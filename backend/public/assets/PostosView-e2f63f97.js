import{_ as I,b as N,r as p,o as S,d as c,e as d,f as n,j as _,V,W as G,n as L,t as h,h as b,w as k,i as C,m as M}from"./index-0b450a74.js";const B={class:"postos-view"},q={class:"container"},F={class:"content-wrapper"},R={class:"map-container"},T={class:"stations-list"},W={class:"stations-list-content"},j={key:0,class:"station-item"},A=["onClick"],D={class:"station-name"},O={class:"station-address"},H={key:0,class:"station-distance"},K={key:1,class:"station-actions"},U={__name:"PostosView",setup(X){const l=N(),v=p(null),u=p(null),f=p([]),m=p([]),y=p(null),P=(e,a)=>{const s=(a.lat-e.lat)*Math.PI/180,r=(a.lng-e.lng)*Math.PI/180,i=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e.lat*Math.PI/180)*Math.cos(a.lat*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 6371*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)))},E=()=>{if(v.value){if(!navigator.geolocation){console.error("Geolocalização não suportada pelo seu navegador");return}navigator.geolocation.getCurrentPosition(e=>{const a={lat:e.coords.latitude,lng:e.coords.longitude};u.value=new google.maps.Map(v.value,{center:a,zoom:14,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1});const o=new google.maps.places.PlacesService(u.value),s={location:a,radius:2e3,keyword:"Posto de combustível",language:"pt-BR"};o.nearbySearch(s,(r,i)=>{i===google.maps.places.PlacesServiceStatus.OK&&r?(f.value.forEach(t=>t.setMap(null)),f.value=[],m.value=[],r.forEach(t=>{t.distance=P(a,{lat:t.geometry.location.lat(),lng:t.geometry.location.lng()})}),r.sort((t,g)=>t.distance-g.distance),r.forEach(t=>{const g=new google.maps.Marker({position:t.geometry.location,map:u.value,title:t.name,icon:{path:google.maps.SymbolPath.CIRCLE,scale:8,fillColor:"#FF0000",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2}});g.addListener("click",()=>{w(t)}),f.value.push(g),m.value.push(t)})):(console.error("Não foi possível encontrar postos próximos:",i),m.value=[])})},e=>{console.error("Erro ao obter localização:",e.message),l.add({severity:"error",summary:"Erro de Localização",detail:"Não foi possível obter sua localização. Por favor, verifique as permissões do navegador.",life:5e3})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}},w=e=>{y.value=e,u.value.setCenter(e.geometry.location),u.value.setZoom(16),l.add({severity:"info",summary:"Posto selecionado",detail:`Você pode traçar uma rota até ${e.name}`,life:3e3})},z=e=>{if(!navigator.geolocation){l.add({severity:"error",summary:"Erro",detail:"Geolocalização não suportada",life:3e3});return}navigator.geolocation.getCurrentPosition(a=>{const o=`${a.coords.latitude},${a.coords.longitude}`,s=`${e.geometry.location.lat()},${e.geometry.location.lng()}`;window.location.href=`comgooglemaps://?saddr=${o}&daddr=${s}&directionsmode=driving`,setTimeout(()=>{window.open(`https://www.google.com/maps/dir/?api=1&origin=${o}&destination=${s}&travelmode=driving`,"_blank")},2e3)},a=>{l.add({severity:"error",summary:"Erro",detail:"Não foi possível obter sua localização",life:3e3})})},$=e=>{if(!navigator.geolocation){l.add({severity:"error",summary:"Erro",detail:"Geolocalização não suportada",life:3e3});return}navigator.geolocation.getCurrentPosition(a=>{const o=e.geometry.location.lat(),s=e.geometry.location.lng();window.location.href=`waze://?ll=${o},${s}&navigate=yes`,setTimeout(()=>{window.open(`https://www.waze.com/ul?ll=${o},${s}&navigate=yes`,"_blank")},2e3)},a=>{l.add({severity:"error",summary:"Erro",detail:"Não foi possível obter sua localização",life:3e3})})},x=()=>new Promise((e,a)=>{if(window.google){e();return}const o=document.createElement("script");o.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD2lfwyGnehINoCdBUCPIypiaOx_f4mwXk&libraries=places,directions",o.async=!0,o.defer=!0,o.onload=e,o.onerror=a,document.head.appendChild(o)});return S(async()=>{try{await x(),E()}catch(e){console.error("Erro ao carregar o Google Maps:",e)}}),(e,a)=>(c(),d("div",B,[n("div",q,[a[1]||(a[1]=n("div",{class:"description"},[n("h2",null,"Postos de Combustível Próximos"),n("p",null,"Encontre os postos mais próximos e planeje sua rota para abastecimento.")],-1)),n("div",F,[n("div",R,[n("div",{id:"map",ref_key:"mapContainer",ref:v},null,512)]),n("div",T,[a[0]||(a[0]=n("h3",null,"Postos Encontrados",-1)),n("div",W,[m.value.length===0?(c(),d("div",j," Nenhum posto encontrado nesta área. ")):_("",!0),(c(!0),d(V,null,G(m.value,(o,s)=>{var r;return c(),d("div",{key:o.place_id,class:L(["station-item",{"nearest-station":s===0}]),onClick:i=>w(o)},[n("div",D,h(o.name),1),n("div",O,h(o.vicinity||"Endereço não disponível"),1),o.distance?(c(),d("div",H,h(o.distance.toFixed(1))+" km ",1)):_("",!0),((r=y.value)==null?void 0:r.place_id)===o.place_id?(c(),d("div",K,[b(C(M),{icon:"pi pi-map",label:"Google Maps",class:"p-button-sm p-button-success mt-2 mr-2 google-maps-btn",onClick:k(i=>z(o),["stop"])},null,8,["onClick"]),b(C(M),{icon:"pi pi-car",label:"Waze",class:"p-button-sm p-button-info mt-2 waze-btn",onClick:k(i=>$(o),["stop"])},null,8,["onClick"])])):_("",!0)],10,A)}),128))])])])])]))}},J=I(U,[["__scopeId","data-v-b91bf0e8"]]);export{J as default};
