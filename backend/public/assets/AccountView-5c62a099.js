import{_ as P,a as I,b as M,r as i,o as $,c as v,d as b,e as h,f as l,t as k,h as s,i as F,k as p,s as H}from"./index-0b450a74.js";const j={class:"minha-conta"},q={class:"content"},z={class:"profile-photo"},L=["src"],T={key:1,class:"pi pi-user"},G={class:"section"},J={class:"user-info-nome"},K={class:"user-info-email"},O={class:"section"},Q={class:"form-grid"},R={class:"field"},W={class:"field"},X={class:"field"},Y={class:"section"},Z={class:"form-grid"},ee={class:"field"},le={class:"field"},ae={class:"actions"},oe={class:"form-grid"},se={class:"field"},ne={class:"field"},te={class:"field"},ie={class:"field mt-4"},re={__name:"AccountView",setup(ue){const C=I(),n=M(),o=i({nome:"",email:"",photo_url:null,cnh_number:"",cnh_category:null,cnh_expiration:null}),d=i(!1),c=i(!1),f=i(!1),g=i(!1),_=i(!1),A=i(null),r=i({current:"",new:"",confirm:""}),y=i(""),w=[{name:"A",value:"A"},{name:"B",value:"B"},{name:"C",value:"C"},{name:"D",value:"D"},{name:"E",value:"E"},{name:"AB",value:"AB"},{name:"AC",value:"AC"},{name:"AD",value:"AD"},{name:"AE",value:"AE"}];$(async()=>{try{const t=await C.fetchProfile();o.value.nome=t.nome||"",o.value.email=t.email||"",o.value.photo_url=null,o.value.cnh_number="",o.value.cnh_category=null,o.value.cnh_expiration=null}catch{n.add({severity:"error",summary:"Erro",detail:"Não foi possível carregar os dados do usuário",life:3e3})}});function D(){A.value.click()}async function S(t){t.target.files[0]&&n.add({severity:"info",summary:"Em desenvolvimento",detail:"Upload de foto será implementado em breve",life:3e3})}async function E(){f.value=!0;try{n.add({severity:"success",summary:"Sucesso",detail:"Alterações salvas com sucesso",life:3e3})}catch{n.add({severity:"error",summary:"Erro",detail:"Não foi possível salvar as alterações",life:3e3})}finally{f.value=!1}}async function x(){if(r.value.new!==r.value.confirm){n.add({severity:"error",summary:"Erro",detail:"As senhas não coincidem",life:3e3});return}g.value=!0;try{n.add({severity:"success",summary:"Sucesso",detail:"Senha alterada com sucesso",life:3e3}),d.value=!1}catch{n.add({severity:"error",summary:"Erro",detail:"Não foi possível alterar a senha",life:3e3})}finally{g.value=!1}}async function N(){if(!y.value){n.add({severity:"error",summary:"Erro",detail:"Digite sua senha para confirmar",life:3e3});return}_.value=!0;try{await C.logout(),router.push("/login")}catch{n.add({severity:"error",summary:"Erro",detail:"Não foi possível apagar a conta",life:3e3})}finally{_.value=!1}}return(t,e)=>{const U=v("Dropdown"),B=v("Calendar"),u=v("Button"),m=v("Password"),V=v("Dialog");return b(),h("div",j,[e[25]||(e[25]=l("div",{class:"header"},[l("h1",null,"Minha Conta")],-1)),l("div",q,[l("div",z,[l("div",{class:"photo-container",onClick:D},[o.value.photo_url?(b(),h("img",{key:0,src:o.value.photo_url,alt:"Foto de perfil"},null,8,L)):(b(),h("i",T)),e[13]||(e[13]=l("div",{class:"photo-overlay"},[l("i",{class:"pi pi-camera"})],-1))]),l("input",{type:"file",ref_key:"fileInput",ref:A,accept:"image/*",style:{display:"none"},onChange:S},null,544)]),l("div",G,[e[14]||(e[14]=l("h2",null,"Informações Pessoais",-1)),l("div",J,k(o.value.nome),1),l("div",K,k(o.value.email),1)]),l("div",O,[e[18]||(e[18]=l("h2",null,"CNH",-1)),l("div",Q,[l("div",R,[e[15]||(e[15]=l("label",null,"Número da CNH",-1)),s(F(H),{modelValue:o.value.cnh_number,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.cnh_number=a)},null,8,["modelValue"])]),l("div",W,[e[16]||(e[16]=l("label",null,"Categoria",-1)),s(U,{modelValue:o.value.cnh_category,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.cnh_category=a),options:w,optionLabel:"name",placeholder:"Selecione a categoria"},null,8,["modelValue"])]),l("div",X,[e[17]||(e[17]=l("label",null,"Validade",-1)),s(B,{modelValue:o.value.cnh_expiration,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.cnh_expiration=a),dateFormat:"dd/mm/yy",showIcon:!0},null,8,["modelValue"])])])]),l("div",Y,[e[19]||(e[19]=l("h2",null,"Segurança",-1)),l("div",Z,[l("div",ee,[s(u,{label:"Alterar Senha",icon:"pi pi-lock",onClick:e[3]||(e[3]=a=>d.value=!0),class:"p-button-outlined"})]),l("div",le,[s(u,{label:"Apagar Conta",icon:"pi pi-trash",onClick:e[4]||(e[4]=a=>c.value=!0),class:"p-button-danger p-button-outlined"})])])]),l("div",ae,[s(u,{label:"Salvar Alterações",icon:"pi pi-save",onClick:E,loading:f.value},null,8,["loading"])])]),s(V,{visible:d.value,"onUpdate:visible":e[9]||(e[9]=a=>d.value=a),header:"Alterar Senha",modal:!0,class:"p-fluid"},{footer:p(()=>[s(u,{label:"Cancelar",icon:"pi pi-times",onClick:e[8]||(e[8]=a=>d.value=!1),class:"p-button-text"}),s(u,{label:"Alterar",icon:"pi pi-check",onClick:x,loading:g.value},null,8,["loading"])]),default:p(()=>[l("div",oe,[l("div",se,[e[20]||(e[20]=l("label",null,"Senha Atual",-1)),s(m,{modelValue:r.value.current,"onUpdate:modelValue":e[5]||(e[5]=a=>r.value.current=a),feedback:!1,toggleMask:""},null,8,["modelValue"])]),l("div",ne,[e[21]||(e[21]=l("label",null,"Nova Senha",-1)),s(m,{modelValue:r.value.new,"onUpdate:modelValue":e[6]||(e[6]=a=>r.value.new=a),toggleMask:""},null,8,["modelValue"])]),l("div",te,[e[22]||(e[22]=l("label",null,"Confirmar Nova Senha",-1)),s(m,{modelValue:r.value.confirm,"onUpdate:modelValue":e[7]||(e[7]=a=>r.value.confirm=a),feedback:!1,toggleMask:""},null,8,["modelValue"])])])]),_:1},8,["visible"]),s(V,{visible:c.value,"onUpdate:visible":e[12]||(e[12]=a=>c.value=a),header:"Apagar Conta",modal:!0},{footer:p(()=>[s(u,{label:"Cancelar",icon:"pi pi-times",onClick:e[11]||(e[11]=a=>c.value=!1),class:"p-button-text"}),s(u,{label:"Apagar Conta",icon:"pi pi-trash",onClick:N,class:"p-button-danger",loading:_.value},null,8,["loading"])]),default:p(()=>[e[24]||(e[24]=l("p",null,"Você tem certeza que deseja apagar sua conta? Esta ação não pode ser desfeita.",-1)),l("div",ie,[e[23]||(e[23]=l("label",null,"Digite sua senha para confirmar",-1)),s(m,{modelValue:y.value,"onUpdate:modelValue":e[10]||(e[10]=a=>y.value=a),feedback:!1,toggleMask:""},null,8,["modelValue"])])]),_:1,__:[24]},8,["visible"])])}}},ve=P(re,[["__scopeId","data-v-61ac85e5"]]);export{ve as default};
