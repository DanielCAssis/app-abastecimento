import{_ as S}from"./logo1-b9c562a1.js";import{_ as C,r as l,o as V,d as u,e as d,f as s,t as r,R as y,u as D,a as q,A as E,S as F,h as _,i as n,V as A,W as P,k as R,m as h,l as B,X as H}from"./index-0b450a74.js";const M={class:"previsao-card"},N={key:0,class:"previsao-loading"},I={key:1,class:"previsao-mensagem"},z={key:2,class:"previsao-conteudo"},T={class:"previsao-item"},U={class:"valor"},W={class:"previsao-item"},G={class:"valor"},Q={__name:"PrevisaoAbastecimento",setup($){const c=l(!0),m=l(!1),g=l(""),p=l(0),b=async()=>{try{c.value=!0;const i=await y.get("/api/vehicles/autonomia");if(i.data&&i.data.proxima_data){m.value=!0;const a=new Date(i.data.proxima_data);g.value=a.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}),p.value=Math.round(i.data.quilometragem_estimada)}else m.value=!1}catch(i){console.error("Erro ao calcular previsão:",i),m.value=!1}finally{c.value=!1}};return V(()=>{b()}),(i,a)=>(u(),d("div",M,[a[5]||(a[5]=s("div",{class:"previsao-header"},[s("i",{class:"pi pi-calendar"}),s("h3",null,"Previsão de Abastecimento")],-1)),c.value?(u(),d("div",N,a[0]||(a[0]=[s("i",{class:"pi pi-spin pi-spinner"},null,-1),s("span",null,"Calculando previsão...",-1)]))):m.value?(u(),d("div",z,[s("div",T,[a[2]||(a[2]=s("span",{class:"label"},"Próximo abastecimento em:",-1)),s("span",U,r(g.value),1)]),s("div",W,[a[3]||(a[3]=s("span",{class:"label"},"Quilometragem estimada:",-1)),s("span",G,r(p.value)+" km",1)]),a[4]||(a[4]=s("div",{class:"previsao-observacao"},[s("i",{class:"pi pi-info-circle"}),s("span",null,"Esta é uma estimativa baseada no seu histórico de abastecimentos")],-1))])):(u(),d("div",I,a[1]||(a[1]=[s("i",{class:"pi pi-info-circle"},null,-1),s("span",null,"Aguardando abastecimentos para obter dados",-1)])))]))}},X=C(Q,[["__scopeId","data-v-02c28b6b"]]);const j={class:"home-bg-new"},J={class:"home-card-new"},K={class:"home-title-new"},O={class:"metrics-grid-new"},Y={class:"metric-card-new"},Z={class:"metric-value"},ss={class:"metric-card-new"},es={class:"metric-value"},as={class:"metric-card-new"},os={class:"metric-value"},is={class:"consumption-cards-list"},ts={class:"vehicle-name"},ls={class:"vehicle-plate"},ns={class:"consumption-value"},rs={__name:"HomeView",setup($){const c=D(),m=q(),g=E(()=>{var t;return((t=m.user)==null?void 0:t.nome)||"Usuário"}),p=l(!1);F();const b=l(0),i=l(0),a=l("0,00"),f=l([]),x=l({}),L=t=>{const e=x.value[t];return e?e.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):"--"};return V(async()=>{try{const t=await y.get("/api/vehicles");f.value=Array.isArray(t.data)?t.data:[],b.value=f.value.length;const e=await y.get("/api/fuelings"),o=Array.isArray(e.data)?e.data:[];i.value=o.length;const k=o.reduce((v,w)=>v+(parseFloat(w.valor_total)||0),0);a.value=k.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2});try{const v=await y.get("/api/medias-consumo",{headers:{"Cache-Control":"no-cache"}});Array.isArray(v.data)&&v.data.forEach(w=>{x.value[w.id_veiculo]=w.media_consumo})}catch(v){console.error("Erro ao buscar médias de consumo:",v)}}catch(t){console.error("Erro ao carregar dados:",t),b.value=0,i.value=0,a.value="0,00",f.value=[],x.value={}}}),(t,e)=>(u(),d(A,null,[s("div",j,[s("div",J,[e[14]||(e[14]=s("div",{class:"home-logo-new"},[s("img",{src:S,alt:"Logo App Abastecimento",class:"logo-img"})],-1)),s("h2",K,"Bem-vindo, "+r(g.value)+"!",1),s("div",O,[s("div",Y,[e[6]||(e[6]=s("div",{class:"metric-icon-new metric-icon-vehicle"},[s("i",{class:"pi pi-car"})],-1)),e[7]||(e[7]=s("div",{class:"metric-label"},"Veículos",-1)),s("div",Z,r(b.value),1),_(n(h),{label:"Ver veículos",class:"metric-btn-new app-btn-main",onClick:e[0]||(e[0]=o=>n(c).push("/vehicles"))})]),s("div",ss,[e[8]||(e[8]=s("div",{class:"metric-icon-new metric-icon-fueling"},[s("i",{class:"pi pi-chart-line"})],-1)),e[9]||(e[9]=s("div",{class:"metric-label"},"Abastecimentos",-1)),s("div",es,r(i.value),1),_(n(h),{label:"Ver abastecimentos",class:"metric-btn-new app-btn-main",onClick:e[1]||(e[1]=o=>n(c).push("/fuelings"))})]),s("div",as,[e[10]||(e[10]=s("div",{class:"metric-icon-new metric-icon-expense"},[s("i",{class:"pi pi-dollar"})],-1)),e[11]||(e[11]=s("div",{class:"metric-label"},"Gastos",-1)),s("div",os,"R$ "+r(a.value),1),_(n(h),{label:"Ver relatórios",class:"metric-btn-new app-btn-main",onClick:e[2]||(e[2]=o=>n(c).push("/reports"))})])]),_(X,{class:"previsao-section"}),s("div",is,[(u(!0),d(A,null,P(f.value,o=>(u(),d("div",{key:o.id,class:"metric-card-new consumption-card"},[e[12]||(e[12]=s("div",{class:"metric-icon-new metric-icon-consumption"},[s("i",{class:"pi pi-chart-bar"})],-1)),e[13]||(e[13]=s("div",{class:"metric-label"},"Consumo Médio",-1)),s("div",ts,r(o.nome),1),s("div",ls,r(o.placa),1),s("div",ns,[B(r(L(o.id))+" km/l ",1),s("i",{class:"pi pi-info-circle info-icon",onClick:e[3]||(e[3]=k=>p.value=!0)})]),_(n(h),{label:"Ver relatórios",class:"metric-btn-new app-btn-main",onClick:e[4]||(e[4]=k=>n(c).push("/reports"))})]))),128))])])]),_(n(H),{visible:p.value,"onUpdate:visible":e[5]||(e[5]=o=>p.value=o),modal:"",header:"Como é calculada a média de consumo?",style:{width:"90vw",maxWidth:"500px"}},{default:R(()=>e[15]||(e[15]=[s("div",{class:"consumption-info"},[s("p",null,"Para garantir um cálculo preciso da média de consumo do seu veículo, o sistema utiliza apenas os intervalos entre dois abastecimentos em que o tanque foi cheio."),s("h4",null,"Exemplo prático:"),s("div",{class:"example-box"},[s("p",null,[s("strong",null,"Primeiro abastecimento (tanque cheio):")]),s("ul",null,[s("li",null,"Hodômetro: 255.000 km"),s("li",null,"Litros abastecidos: 8,08 L")]),s("p",null,[s("strong",null,"Segundo abastecimento (tanque cheio):")]),s("ul",null,[s("li",null,"Hodômetro: 255.040 km"),s("li",null,"Litros abastecidos: 6,46 L")]),s("p",null,[s("strong",null,"Cálculo:")]),s("ul",null,[s("li",null,"Distância percorrida: 40 km (255.040 - 255.000)"),s("li",null,"Combustível consumido: 6,46 L"),s("li",null,"Média de consumo: 6,19 km/L (40 ÷ 6,46)")])]),s("div",{class:"tips-box"},[s("h4",null,"Dicas importantes:"),s("ul",null,[s("li",null,"Sempre registre o hodômetro ao abastecer"),s("li",null,"Realize abastecimentos com tanque cheio sempre que possível"),s("li",null,"Se o último abastecimento não foi com o tanque cheio, a média não poderá ser calculada com precisão")])])],-1)])),_:1,__:[15]},8,["visible"])],64))}},ds=C(rs,[["__scopeId","data-v-e8cbcad6"]]);export{ds as default};
